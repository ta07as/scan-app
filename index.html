<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ScanApp Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        body { 
            background-color: #000; 
            color: white; 
            font-family: 'Inter', sans-serif; 
            overflow: hidden; 
            margin: 0;
            height: 100vh;
            width: 100vw;
            -webkit-tap-highlight-color: transparent;
        }
        
        #video-container { 
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1;
        }

        video { width: 100%; height: 100%; object-fit: cover; }

        .focus-area {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex; align-items: center; justify-content: center;
            pointer-events: none;
            z-index: 10;
            padding-top: var(--safe-top);
            padding-bottom: 180px;
        }

        .focus-box {
            width: 85%;
            aspect-ratio: 3/4;
            max-height: 50vh;
            border-radius: 30px;
            position: relative;
            box-shadow: 0 0 0 4000px rgba(0,0,0,0.7);
        }

        .corner { 
            position: absolute; width: 35px; height: 35px; border: 5px solid #10b981; 
            filter: drop-shadow(0 0 10px rgba(16, 185, 129, 0.5));
        }
        .tl { top: -2px; left: -2px; border-right: 0; border-bottom: 0; border-top-left-radius: 20px; }
        .tr { top: -2px; right: -2px; border-left: 0; border-bottom: 0; border-top-right-radius: 20px; }
        .bl { bottom: -2px; left: -2px; border-right: 0; border-top: 0; border-bottom-left-radius: 20px; }
        .br { bottom: -2px; right: -2px; border-left: 0; border-top: 0; border-bottom-right-radius: 20px; }

        .scan-line {
            position: absolute; left: 5%; width: 90%; height: 3px;
            background: #10b981; box-shadow: 0 0 20px #10b981;
            display: none; z-index: 11;
            animation: scanning 2s infinite ease-in-out;
        }
        @keyframes scanning {
            0% { top: 10%; opacity: 0; }
            50% { opacity: 1; }
            100% { top: 90%; opacity: 0; }
        }

        .controls { 
            position: absolute; bottom: 0; left: 0; right: 0; 
            padding: 20px 20px calc(25px + var(--safe-bottom)); 
            background: linear-gradient(to top, rgba(0,0,0,0.95) 80%, transparent);
            z-index: 50; 
        }

        .glass { 
            background: rgba(255, 255, 255, 0.08); 
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1); 
        }
        
        .btn-active { background: #10b981 !important; color: white !important; }
        .action-btn { transition: transform 0.1s; display: flex; align-items: center; justify-content: center; }
        .action-btn:active { transform: scale(0.9); }

        /* –û–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
        .modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 1000; display: none; flex-direction: column;
            align-items: center; justify-content: center; padding: 20px;
        }

        #gallery-input { display: none; }
    </style>
</head>
<body>

<input type="file" id="gallery-input" accept="image/*" onchange="processFile(event)">

<div id="video-container">
    <video id="camera" autoplay playsinline muted></video>
    <div class="focus-area">
        <div class="focus-box">
            <div id="scan-line" class="scan-line"></div>
            <div class="corner tl"></div><div class="corner tr"></div>
            <div class="corner bl"></div><div class="corner br"></div>
        </div>
    </div>
    
    <div class="controls">
        <div class="flex justify-between gap-2 mb-8">
            <button onclick="setFormat('PDF', this)" class="format-btn flex-1 py-3 rounded-2xl glass text-[10px] font-black tracking-widest text-gray-400">PDF</button>
            <button onclick="setFormat('Word', this)" class="format-btn flex-1 py-3 rounded-2xl glass text-[10px] font-black tracking-widest text-gray-400">WORD</button>
            <button onclick="setFormat('Excel', this)" class="format-btn btn-active flex-1 py-3 rounded-2xl glass text-[10px] font-black tracking-widest">EXCEL</button>
        </div>
        
        <div class="flex items-center justify-around">
            <button onclick="document.getElementById('gallery-input').click()" class="w-14 h-14 glass rounded-2xl action-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
            </button>

            <button onclick="runScan()" class="w-20 h-20 bg-white rounded-full p-1 action-btn">
                <div class="w-full h-full rounded-full border-[3px] border-black flex items-center justify-center">
                    <div class="w-12 h-12 bg-emerald-500 rounded-full shadow-[0_0_15px_#10b981]"></div>
                </div>
            </button>

            <button onclick="document.getElementById('gallery-input').click()" class="w-14 h-14 glass rounded-2xl action-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
            </button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è -->
<div id="result-modal" class="modal">
    <div class="w-full max-w-xs glass p-8 rounded-[40px] text-center">
        <div class="text-5xl mb-6">‚úÖ</div>
        <h2 class="text-xl font-bold mb-2">–ì–æ—Ç–æ–≤–æ!</h2>
        <p id="result-info" class="text-xs text-gray-400 mb-8 uppercase tracking-widest italic"></p>
        
        <div class="space-y-3">
            <button onclick="sendToWhatsApp()" class="w-full py-4 bg-[#25D366] text-black font-black rounded-2xl action-btn text-sm flex items-center justify-center gap-2">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12.031 6.172c-2.271 0-4.131 1.86-4.131 4.132 0 .917.29 1.761.782 2.449l-.513 1.871 1.921-.505c.579.313 1.241.493 1.941.493 2.271 0 4.131-1.86 4.131-4.132 0-2.271-1.86-4.132-4.131-4.132zm2.345 5.897c-.1.258-.585.501-.81.533-.225.032-.449.06-.713-.032-.263-.092-.589-.236-.93-.418-.342-.182-.647-.417-.899-.688-.252-.271-.439-.588-.535-.873-.096-.285-.02-.439.055-.544.076-.104.168-.204.252-.303.084-.1.112-.168.168-.28.056-.112.028-.21-.014-.309-.042-.099-.379-.914-.52-1.251-.137-.333-.277-.288-.379-.293h-.322c-.112 0-.294.042-.449.21-.155.168-.589.575-.589 1.402 0 .827.603 1.626.687 1.738.084.112 1.185 1.81 2.872 2.537.401.173.714.277.958.354.403.128.769.11 1.059.067.323-.048.995-.407 1.135-.8.14-.393.14-.73.098-.8-.042-.07-.154-.112-.323-.196z"/></svg>
                –í WHATSAPP
            </button>
            <button onclick="downloadFile()" class="w-full py-4 glass text-white font-black rounded-2xl action-btn text-sm">
                –°–ö–ê–ß–ê–¢–¨ –§–ê–ô–õ
            </button>
            <button onclick="location.reload()" class="w-full py-4 text-gray-500 font-bold text-[10px] tracking-widest uppercase">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
        </div>
    </div>
</div>

<div id="loader" class="fixed inset-0 bg-black z-[500] hidden flex flex-col items-center justify-center text-center px-10">
    <div class="w-16 h-16 border-[4px] border-emerald-500/10 border-t-emerald-500 rounded-full animate-spin"></div>
    <p id="loader-text" class="mt-8 text-[11px] font-black tracking-[0.3em] text-emerald-500 uppercase italic">ANALYZING...</p>
</div>

<script>
    let currentMode = 'Excel';
    let processedFileName = "";
    const video = document.getElementById('camera');
    const loader = document.getElementById('loader');
    const scanLine = document.getElementById('scan-line');

    async function initCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
            video.srcObject = stream;
        } catch (err) { console.log("–ö–∞–º–µ—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"); }
    }

    function setFormat(mode, btn) {
        currentMode = mode;
        document.querySelectorAll('.format-btn').forEach(b => b.classList.remove('btn-active'));
        btn.classList.add('btn-active');
    }

    function processFile(event) {
        const file = event.target.files[0];
        if (!file) return;
        startProcessing(file.name);
    }

    function runScan() {
        scanLine.style.display = 'block';
        startProcessing("—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ñ–æ—Ç–æ");
    }

    function startProcessing(name) {
        processedFileName = name;
        showLoader("–°–ö–ê–ù–ò–†–û–í–ê–ù–ò–ï...");
        
        setTimeout(() => {
            showLoader("AI-–£–õ–£–ß–®–ï–ù–ò–ï –ö–ê–ß–ï–°–¢–í–ê...");
            setTimeout(() => {
                showLoader(`–ö–û–ù–í–ï–†–¢–ê–¶–ò–Ø –í ${currentMode}...`);
                setTimeout(() => {
                    hideLoader();
                    scanLine.style.display = 'none';
                    showModal();
                }, 2000);
            }, 1500);
        }, 1500);
    }

    function showModal() {
        document.getElementById('result-info').innerText = `${processedFileName} ‚Üí ${currentMode}`;
        document.getElementById('result-modal').style.display = 'flex';
    }

    function sendToWhatsApp() {
        const phone = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä WhatsApp (–Ω–∞–ø—Ä–∏–º–µ—Ä, 79991234567) –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞:");
        const msg = `ScanApp Result:\nüìÅ –§–∞–π–ª: ${processedFileName}\nüîÑ –§–æ—Ä–º–∞—Ç: ${currentMode}\n‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ: –£–ª—É—á—à–µ–Ω–æ (AI)`;
        const url = phone ? `https://wa.me/${phone}?text=${encodeURIComponent(msg)}` : `https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`;
        window.open(url, '_blank');
    }

    function downloadFile() {
        const link = document.createElement('a');
        link.href = '#';
        link.download = `${processedFileName}.${currentMode.toLowerCase()}`;
        alert(`–§–∞–π–ª ${processedFileName}.${currentMode.toLowerCase()} —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ø–∞–º—è—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞`);
    }

    function showLoader(text) {
        document.getElementById('loader-text').innerText = text;
        loader.classList.remove('hidden');
    }

    function hideLoader() { loader.classList.add('hidden'); }

    window.onload = initCamera;
</script>
</body>
</html>

                    
