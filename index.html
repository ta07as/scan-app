<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ScanApp | Electrician Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap" rel="stylesheet">
    <style>
        body { 
            background-color: #050505; 
            color: white; 
            font-family: 'Inter', sans-serif; 
            overflow: hidden; 
            margin: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        .glass { 
            background: rgba(255, 255, 255, 0.03); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08); 
        }
        
        #video-container { position: relative; width: 100%; height: 100vh; background: #000; }
        video { width: 100%; height: 100%; object-fit: cover; }

        /* Фокус камеры */
        .focus-area {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            pointer-events: none;
        }
        .focus-box {
            width: 75%; height: 55%;
            border-radius: 24px;
            position: relative;
            box-shadow: 0 0 0 2000px rgba(0,0,0,0.5);
        }
        .corner { position: absolute; width: 25px; height: 25px; border: 3px solid #10b981; }
        .tl { top: -2px; left: -2px; border-right: 0; border-bottom: 0; border-top-left-radius: 12px; }
        .tr { top: -2px; right: -2px; border-left: 0; border-bottom: 0; border-top-right-radius: 12px; }
        .bl { bottom: -2px; left: -2px; border-right: 0; border-top: 0; border-bottom-left-radius: 12px; }
        .br { bottom: -2px; right: -2px; border-left: 0; border-top: 0; border-bottom-right-radius: 12px; }

        .scan-line {
            position: absolute; top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(to bottom, transparent, #10b981, transparent);
            box-shadow: 0 0 20px #10b981;
            display: none;
            animation: scanning 2.5s infinite linear;
        }
        @keyframes scanning {
            0% { top: 22%; }
            50% { top: 78%; }
            100% { top: 22%; }
        }

        .controls { 
            position: absolute; bottom: 0; left: 0; right: 0; 
            padding: 25px 25px 40px; 
            border-radius: 40px 40px 0 0; 
            z-index: 50; 
        }
        
        .btn-active { background: #10b981 !important; color: white !important; }

        /* Экраны */
        .overlay-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #050505; z-index: 100; display: none;
            padding: 20px; overflow-y: auto;
        }

        .action-btn { transition: transform 0.1s; }
        .action-btn:active { transform: scale(0.92); }
    </style>
</head>
<body>

<div id="video-container">
    <video id="camera" autoplay playsinline muted></video>
    <div id="scan-line" class="scan-line"></div>
    
    <div class="focus-area">
        <div class="focus-box">
            <div class="corner tl"></div>
            <div class="corner tr"></div>
            <div class="corner bl"></div>
            <div class="corner br"></div>
        </div>
    </div>
    
    <div class="controls glass">
        <div class="flex justify-between gap-2 mb-8">
            <button onclick="changeFormat('PDF', this)" class="format-btn flex-1 py-3 rounded-xl glass text-xs font-bold text-gray-400">PDF</button>
            <button onclick="changeFormat('Word', this)" class="format-btn flex-1 py-3 rounded-xl glass text-xs font-bold text-gray-400">WORD</button>
            <button onclick="changeFormat('Excel', this)" class="format-btn btn-active flex-1 py-3 rounded-xl glass text-xs font-bold">EXCEL</button>
        </div>
        
        <div class="flex items-center justify-between px-4">
            <button onclick="openFiles()" class="p-4 glass rounded-2xl action-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>
            </button>

            <button onclick="startScan()" class="w-20 h-20 bg-white rounded-full p-1 flex items-center justify-center action-btn shadow-[0_0_30px_rgba(16,185,129,0.4)]">
                <div class="w-full h-full rounded-full border-4 border-black flex items-center justify-center">
                    <div class="w-12 h-12 bg-emerald-500 rounded-full"></div>
                </div>
            </button>

            <button onclick="openFiles()" class="p-4 glass rounded-2xl action-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
            </button>
        </div>
        <p class="text-center text-[10px] text-gray-600 mt-6 tracking-widest font-black uppercase">Electrician Pro Scan</p>
    </div>
</div>

<!-- Экран Файлов -->
<div id="files-screen" class="overlay-screen">
    <div class="flex justify-between items-center mb-10">
        <h2 class="text-3xl font-black tracking-tighter italic">FILES</h2>
        <button onclick="closeScreens()" class="w-10 h-10 glass rounded-full flex items-center justify-center">✕</button>
    </div>
    
    <div class="space-y-4">
        <div class="glass p-5 rounded-[24px] flex items-center gap-4 action-btn" onclick="startConvert('Проект_Смета.pdf', 'PDF')">
            <div class="w-12 h-12 bg-red-500/10 text-red-500 rounded-xl flex items-center justify-center font-bold">PDF</div>
            <div class="flex-1">
                <h4 class="font-bold text-sm">Проект_Смета.pdf</h4>
                <p class="text-[10px] text-gray-500 italic uppercase tracking-wider">Нажми для конвертации</p>
            </div>
        </div>
        <div class="glass p-5 rounded-[24px] flex items-center gap-4 action-btn" onclick="startConvert('Цены_Материалы.xlsx', 'Excel')">
            <div class="w-12 h-12 bg-emerald-500/10 text-emerald-500 rounded-xl flex items-center justify-center font-bold">XLS</div>
            <div class="flex-1">
                <h4 class="font-bold text-sm">Цены_Материалы.xlsx</h4>
                <p class="text-[10px] text-gray-500 italic uppercase tracking-wider">Нажми для конвертации</p>
            </div>
        </div>
    </div>
</div>

<!-- Экран Выбора Конвертации -->
<div id="convert-modal" class="overlay-screen !bg-black/80 flex items-center justify-center backdrop-blur-md">
    <div class="glass w-full max-w-xs p-8 rounded-[40px] text-center">
        <div class="text-4xl mb-4">⚙️</div>
        <h3 id="target-filename" class="font-bold mb-2">file.pdf</h3>
        <p class="text-xs text-gray-500 mb-8 italic">Выбери формат переработки:</p>
        <div id="convert-options" class="space-y-3"></div>
        <button onclick="closeScreens()" class="mt-6 text-[10px] font-black text-gray-600 uppercase tracking-widest">Отмена</button>
    </div>
</div>

<!-- Индикатор загрузки -->
<div id="loader" class="fixed inset-0 bg-black/90 z-[500] hidden flex flex-col items-center justify-center">
    <div class="w-12 h-12 border-2 border-emerald-500/20 border-t-emerald-500 rounded-full animate-spin"></div>
    <p id="loader-text" class="mt-4 text-[10px] font-black tracking-widest text-emerald-500">PROCESSING...</p>
</div>

<script>
    let currentMode = 'Excel';
    const video = document.getElementById('camera');
    const loader = document.getElementById('loader');

    // Инициализация камеры
    async function initCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "environment" } 
            });
            video.srcObject = stream;
        } catch (err) {
            console.log("Камера недоступна");
        }
    }

    function changeFormat(mode, btn) {
        currentMode = mode;
        document.querySelectorAll('.format-btn').forEach(b => b.classList.remove('btn-active'));
        btn.classList.add('btn-active');
    }

    function startScan() {
        document.getElementById('scan-line').style.display = 'block';
        showLoader("СКАНИРОВАНИЕ...");
        setTimeout(() => {
            document.getElementById('scan-line').style.display = 'none';
            hideLoader();
            shareResult(currentMode);
        }, 2000);
    }

    function openFiles() {
        document.getElementById('files-screen').style.display = 'block';
    }

    function startConvert(name, fromType) {
        document.getElementById('target-filename').innerText = name;
        const options = ['PDF', 'Word', 'Excel'].filter(t => t !== fromType);
        const container = document.getElementById('convert-options');
        container.innerHTML = '';
        
        options.forEach(opt => {
            const b = document.createElement('button');
            b.className = "w-full py-4 glass rounded-2xl font-bold text-sm text-emerald-400 action-btn";
            b.innerText = `В ${opt.toUpperCase()}`;
            b.onclick = () => {
                showLoader(`КОНВЕРТАЦИЯ В ${opt}...`);
                setTimeout(() => {
                    hideLoader();
                    shareResult(opt);
                }, 2500);
            };
            container.appendChild(b);
        });
        
        document.getElementById('convert-modal').style.display = 'flex';
    }

    function shareResult(format) {
        const phone = "996755000228";
        const msg = `Привет! Я переработал файл в формат ${format} через своё приложение ScanApp.`;
        window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        closeScreens();
    }

    function showLoader(text) {
        document.getElementById('loader-text').innerText = text;
        loader.classList.remove('hidden');
    }

    function hideLoader() { loader.classList.add('hidden'); }

    function closeScreens() {
        document.querySelectorAll('.overlay-screen').forEach(s => s.style.display = 'none');
    }

    window.onload = initCamera;
</script>
</body>
</html>

              
